<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Elliot Hohn">

<title>Understanding the relationship between stocks of community wealth and food system</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="capstone_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="capstone_report_files/libs/quarto-html/quarto.js"></script>
<script src="capstone_report_files/libs/quarto-html/popper.min.js"></script>
<script src="capstone_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="capstone_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="capstone_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="capstone_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="capstone_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="capstone_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="capstone_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Understanding the relationship between stocks of community wealth and food system</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Elliot Hohn </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Community wealth quantification outline.</p>
<p>LAMP grant program description.</p>
<p>Hypothesis re: relationship between the two.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>Plan right now is load county level community wealth data, and LAMP grant data, identify counties with low grant funding amounts (or maybe split into high, medium, and low?), then perform cluster analysis to determine common characteristics of the counties in each group, if any.</p>
</section>
<section id="environment-setup" class="level2">
<h2 class="anchored" data-anchor-id="environment-setup">Environment setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-community-stocks-data" class="level2">
<h2 class="anchored" data-anchor-id="load-community-stocks-data">Load community stocks data</h2>
<p>Load data directly from CSU <a href="https://github.com/CSU-Local-and-Regional-Food-Systems" title="CSU Local and Regional Food Systems repo">github repo</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>comm_stocks_url <span class="ot">&lt;-</span> <span class="st">'https://raw.githubusercontent.com/CSU-Local-and-Regional-Food-Systems/USDA-AMS-Data-and-Metrics/main/Indicators%20of%20Community%20Wealth/community_wealth.csv'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>comm_stocks <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(comm_stocks_url)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to add leading 0 to 4-digit fips values in comm_stocks</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>add_leading_zero <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if the number has 4 digits</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x) <span class="sc">==</span> <span class="dv">4</span>, <span class="fu">paste0</span>(<span class="st">"0"</span>, x), x)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>comm_stocks<span class="sc">$</span>fips <span class="ot">&lt;-</span> <span class="fu">sapply</span>(comm_stocks<span class="sc">$</span>fips, add_leading_zero)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(comm_stocks))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   fips    county_name state_name                  category     topic_area year
1 01001 Autauga County    Alabama Community Characteristics Infrastructure 2007
2 01003 Baldwin County    Alabama Community Characteristics Infrastructure 2007
3 01005 Barbour County    Alabama Community Characteristics Infrastructure 2007
4 01007    Bibb County    Alabama Community Characteristics Infrastructure 2007
5 01009  Blount County    Alabama Community Characteristics Infrastructure 2007
6 01011 Bullock County    Alabama Community Characteristics Infrastructure 2007
  variable_name      value
1    highway_km 0.12519374
2    highway_km 0.06419832
3    highway_km 0.01535104
4    highway_km 0.04835747
5    highway_km 0.05661337
6    highway_km 0.02661536</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(comm_stocks, aes(x = value)) + </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_histogram(fill = 'red', colour = 'black') + </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(variable_name ~ .)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(comm_stocks<span class="sc">$</span>variable_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "highway_km"                        "foodbev_est_CBP"                  
 [3] "est_CBP"                           "broad_11"                         
 [5] "broad_16"                          "pc1b_manufacturing"               
 [7] "pc2b_infrastructure"               "create_indus"                     
 [9] "racial_div"                        "pub_lib"                          
[11] "create_jobs"                       "museums"                          
[13] "pc1c_artsdiversity"                "pc2c_creativeindustries"          
[15] "localgovfin"                       "owner_occupied"                   
[17] "deposits"                          "pc1f"                             
[19] "ed_attain"                         "food_secure"                      
[21] "insured"                           "primary_care"                     
[23] "health_factors"                    "health_outcomes"                  
[25] "pc1h_healtheducation"              "pc2h_medicalfoodsecurity"         
[27] "natamen_scale"                     "prime_farmland"                   
[29] "conserve_acre"                     "acre_FSA"                         
[31] "acre_NFS"                          "pc1n_naturalamenitiesconservation"
[33] "pc2n_farmland"                     "pvote"                            
[35] "nccs"                              "assn"                             
[37] "respn"                             "pc1s_nonprofitsocialindustries"   
[39] "pc2s_publicvoiceparticipation"    </code></pre>
</div>
</div>
<section id="check-correlations-between-variables" class="level3">
<h3 class="anchored" data-anchor-id="check-correlations-between-variables">Check correlations between variables</h3>
<p>There are different years associated with the rows of data…how should I deal with this? Filter to only the newest data? Use the average? The grants data will also have a date associate with it, but I was thinking those grants would all be summed to get a “total amount invested” value.</p>
<p>I think for now I’m going to use the mean across all years for any given variable. A quick look at the data indicates that the values don’t shift drastically from year to year, unsurprisingly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape data from tall to wide to give each variable its own column</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>comm_stocks_wide <span class="ot">&lt;-</span> comm_stocks <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fips, year, variable_name, value) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fips, variable_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable_name, <span class="at">values_from =</span> value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fips'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(comm_stocks_wide[, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(comm_stocks_wide)], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(correlation, <span class="at">method =</span> <span class="st">'square'</span>, <span class="at">tl.cex =</span> <span class="fl">0.4</span>, <span class="at">tl.col =</span> <span class="st">'black'</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">'upper'</span>, <span class="at">order =</span> <span class="st">"hclust"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="capstone_report_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="load-counties-shapefile-and-join-to-community-stocks-data" class="level3">
<h3 class="anchored" data-anchor-id="load-counties-shapefile-and-join-to-community-stocks-data">Load counties shapefile and join to community stocks data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>counties <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">'data/cb_2021_us_county_20m/cb_2021_us_county_20m.shp'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>STATE_NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Alaska'</span>, <span class="st">'Hawaii'</span>, <span class="st">'Puerto Rico'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">5070</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `cb_2021_us_county_20m' from data source 
  `/Users/elliot/Documents/repos/fas-capstone/data/cb_2021_us_county_20m/cb_2021_us_county_20m.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 3221 features and 12 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -179.1743 ymin: 17.91377 xmax: 179.7739 ymax: 71.35256
Geodetic CRS:  NAD83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>comm_stocks_geo <span class="ot">&lt;-</span> <span class="fu">merge</span>(counties, comm_stocks_wide, <span class="at">by.x =</span> <span class="st">'GEOID'</span>, <span class="at">by.y =</span> <span class="st">'fips'</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comm_stocks_geo) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> food_secure)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span><span class="st">"Food Security"</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"BrBG"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="dv">1</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">"cm"</span>),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>,<span class="st">"cm"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="capstone_report_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> comm_stocks <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable_name) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(value),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(value),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(value),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(value)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 39 × 6
   variable_name     mean    median       sd      max     min
   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 acre_FSA        0.0148   0.00330   0.0262    0.254 0      
 2 acre_NFS        0.0476   0         0.124     0.936 0      
 3 assn            1.40     1.27      0.717     7.08  0      
 4 broad_11        0.267    0.00871   0.353     1     0      
 5 broad_16        0.635    0.73      0.323     1     0      
 6 conserve_acre   0.0143   0.00392   0.0278    0.284 0      
 7 create_indus  161.     139.      111.     1779.    0      
 8 create_jobs     0.160    0.150     0.0584    0.502 0.00540
 9 deposits       22.5     16.9      51.1    2363.    0      
10 ed_attain       0.262    0.235     0.119     1.22  0.0244 
# ℹ 29 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="load-lamp-data" class="level2">
<h2 class="anchored" data-anchor-id="load-lamp-data">Load LAMP data</h2>
<p>Data downloaded directly from URL on the LAMP Navigator <a href="https://www.ams.usda.gov/data/lamp-navigator" title="LAMP Navigator web pagef">webpage</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lamp_url <span class="ot">&lt;-</span> <span class="st">'https://www.ams.usda.gov/sites/default/files/media/LAMPDatasetandDataDictionary.xlsx'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>lamp <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(lamp_url, <span class="at">sheet =</span> <span class="st">'LAMP Dataset 2006 to 2023'</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(lamp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                  Organization          City.2
1                                      FRESHFARM Markets, Inc.      Washington
2                               Jesus Provides Our Daily Bread           Chico
3           County of Riverside Office of Economic Development       Riverside
4 San Luis Obispo County Community College District dba Cuesta San Luis Obispo
5                            Sierra Kings Health Care District         Reedley
6            Historic St. Andrews Waterfront Partnership, Inc.     Panama City
  State   Zip Congressional.District Project.Congressional.District
1    DC 20010                      1                              1
2    CA 95928                      1                              1
3    CA 92501                     25                             25
4    CA 93405                     24                             24
5    CA 93654                     21                             21
6    FL 32401                      2                              2
                                              Entity.Type Year
1                                   Nonprofit Corporation 2023
2                                   Nonprofit Corporation 2023
3                                        Local Government 2023
4 Public/State Controlled Institution of Higher Education 2023
5                                        Local Government 2023
6                                   Nonprofit Corporation 2023
  Unique.Project.Number Grant.Type      Project.Type Project.Count
1           2023FMPPDC1       FMPP Capacity Building             1
2           2023FMPPCA2       FMPP Capacity Building             1
3           2023FMPPCA3       FMPP Capacity Building             1
4           2023FMPPCA4       FMPP Capacity Building             1
5           2023FMPPCA5       FMPP Capacity Building             1
6           2023FMPPFL6       FMPP Capacity Building             1
  Match.Amount.(Final) Award.Amount Total.Project.Cost
1             125089.4     500000.0           625089.4
2              65150.0     250000.0           315150.0
3              45245.0     180980.0           226225.0
4              52000.0     207046.5           259046.5
5              69512.0     114900.0           184412.0
6              55132.0     220000.0           275132.0
                                                                                                                                                                                             Project.Title
1                                                                                             Harnessing New Opportunities for Farmers and Communities to Strengthen our Mid-Atlantic Regional Food System
2                                                               Harvesting Hope: Addressing Food Insecurity in Butte County, California Through CSA Expansion, Vocational Training, and Consumer Education
3                                Enriching and nourishing the agricultural communities in the Blythe and Palo Verde Valley areas with a direct producer to consumer Farmers’ Market serving local markets.
4                                                                                                    Capacity Building: Expanding Education Access through Farmers' Market Collaboration at Cuesta College
5                               Reedley Wellness Farmer’s Market; creating an attractive market for vendors and consumers to increase consumption of local foods and participation in wellness activities.
6 Execute the "Farm to Town" initiative to include, in part, a new farmers market in Panama City's Glenwood neighborhood, a comprehensive marketing plan, and the creation of a food distribution network.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Project.Abstract/Goal
1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Though the COVID-19 pandemic was highly challenging for small farmers and ranchers and our food systems overall, consumers found new reasons to see these producers as reliable sources of fresh foods. FRESHFARM is poised to innovate to meet the needs and opportunities of this post-pandemic food and economic landscape by: supporting increased economic sustainability for our more than 250 producers through farmers markets and farm stands; growing the customer base and loyalty for local food with promotion and education through at-market signage, video, our website, and loyalty programs; mobilizing new frontiers for market data with a sophisticated platform benefitting all producers in our network; and creating and sustaining vibrant direct producer-to-consumer outlets for\r\nlow-income/low-access communities. 
2 Butte County is burdened by some of the highest food insecurity rates in the state and nation, with nearly 31,300 residents in the rural Northern California county struggling with basic access to healthy food. At the same time, 98% of the food produced in the agriculturally‐rich county is sold out of the area, according to a 2022 assessment conducted by the Butte County Local Food Network. Though local need is strong, there are significant gaps constricting access to locally‐produced food.  The purpose is to increase access and availability of local fruits and vegetables to food insecure Butte County residents, Jesus Provides Our Daily Bread  seeks to develop and expand the capacity of its successful Harvesting Hope Community‐Supported Agriculture Program aka Harvesting Hope. The program currently serves Butte County residents with bi‐weekly local produce boxes, with much of the produce cultivated by individuals experiencing homelessness, through a holistic vocational training program\r\noffered by the Jesus Center. Through this new effort, Harvesting Hope will expand infrastructure to launch a new retail access point for direct‐to consumer‐sales in a disadvantaged community, expand experiential vocational training serving beginning, underserved, and small farmers and drive increased consumption of local produce through new educational marketing efforts targeting food‐insecure consumers. Expected outcomes are 30 trained in small farm production practices and total annual sales beginning in Year 2 of $90,000, with intended beneficiaries the 1,000 individual consumers and 10 farms served by the new retail market access point and the 30 trained through experiential vocational training.\r\n
3                                                                                                                                                                                                                                                                                                                                                                                                            This grant award is being requested by Riverside County Office of Economic Development in partnership with the Blythe Chamber of Commerce to improve the economic conditions of the agricultural producers in the underserved communities of Blythe and the Palo Verde Valley and their residents by developing, operating and expanding a direct producer to consumer Farmers’ Market, to improve access to and consumption of locally and regionally produced agricultural goods, provide critical business and marketing training programs to increase sales, retain existing jobs and create new jobs, respond to the climate crisis and water allocation cuts. A subaward will be granted to the Blythe Chamber of Commerce for outreach, recruitment and retention of producers, outreach, recruitment and retention of Farmers’ Market vendors, outreach, recruitment and retention of customers, management of Farmers’ Market administrative staff, weekly operations oversight of markets, electronic marketing and social media marketing, data collection and sharing with Project Director and local stakeholders and direct community engagement. The intended beneficiaries are the agricultural producers and residents of Blythe and the Palo Verde Valley areas. This grant award is critical to improving the economic outlook for the local economy.
4                                                                                                    Cuesta College will collaborate with local economic and food production stakeholders to provide a new direct-to-consumer market that supports underserved farmers and ranchers and provides expanded food access to residents. This project’s purpose is to address accessibility to local food and direct-to-consumer food systems and cultivate regional food economies through collaborative partnerships. Activities include a feasibility study, business development plan, and initial implementation for a new farmers' market in San Luis Obispo County. \r\nCuesta College will initiate a sustainable, community-based enterprise with a triple bottom line – benefit to local producers (with additional support for underrepresented producers), local consumers with limited access to local food infrastructure, and community college students. The project’s projected impacts include expanded direct-to-consumer market opportunities for local farm and ranch operations, increased participation from underrepresented producers, and increased access to local food for community residents, particularly those living within or adjacent to the designated low-income/low-access area. Intended outcomes include one new direct producer-to-consumer market access point established, at least 50 producers reporting increased engagement with the new market, and a minimum of 100 new local agricultural product customers. \r\nIncome from the market will help fund student employment at the market, introducing them to higher education and opportunities to study and pursue careers in agriculture that require training beyond high school.\r\n
5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              The purpose of the Greater Reedley Farm-To-Table Farmer's Market is to bring consumers face-to-face with farmers to increase consumption of fresh fruits and vegetables while also providing a low-barrier entry point for local farmers to sell produce. Market activities and deliverables are two 10-week markets annually (fall and spring) that will include 1) fresh fruit and/or vegetable vendors (local producers/vendors preferred); 2) food preparation demonstrations, allowing participants to observe the preparation of fresh fruit and vegetables and taste testing; 3) a demonstration and participation in a physical activity such as Zumba, yoga, pickle ball, etc. To increase Market attraction, vendors selling processed foods such as local honey, almonds, olive oil, roasted coffee, crafts booths, and local entertainment will also be included. Market activities are uniquely designed to increase the consumption of fresh produce as a strategy to address the high occurrence of obesity/diabetes in this geographically isolated area where rates are roughly 35%, which is significantly higher than California rates of only 25%.
6                     The Historic St. Andrews Waterfront Partnership, in collaboration with the Panama City Community Redevelopment Agency (CRA) and The LEAD Coalition of Bay County, seeks funding to implement “Farm to Town,” and initiative that will solidify an existing local farmers market—The Market at St. Andrews— and the proposed new Glenwood Farmers Market as reliable and flourishing resources that improve access to fresh, healthy food. This proposed project involves three primary components: • Launch a new farmers market to serve the Glenwood neighborhood of Panama City, classified a food desert, modeled after The Market at St. Andrews, which is owned and operated by the Waterfront Partnership; • In collaboration with a contracted full-service marketing firm (TBD), develop and implement a consumer marketing strategy that aims to increase market visitation while ensuring visitors understand the benefits of healthy eating and are prompted to take advantage of the markets’ provision of fresh food, and • Under the direction of the consulting services of Red Tomato (Providence, RI), establish a food distribution network that allows farms/farmers outside of the conveniently drivable range of Panama City to utilize the St. Andrews and Glenwood markets as sales mechanisms for their produce, meats, poultry, and other locally grown agricultural products. Ultimately, these activities will further activate public community gathering places, secure and grow the base of agricultural producers and growers participating in local farmers markets, and improve conditions surrounding the lack of access to fresh, healthy food for those residing in the St. Andrews and Glenwood neighborhoods and beyond.
  Project.Start.Date Project.End.Date Aggregation Agritourism
1          9/30/2023        9/29/2026           0           0
2          9/30/2023            46294           0           0
3          9/30/2023        9/29/2026           0           1
4          9/30/2023        9/29/2026           0           0
5          9/30/2023            46294           0           0
6          9/30/2023        9/29/2026           1           0
  Farm.to.Institution/Wholesale Food.Safety Food.Waste Grantwriting
1                             0           0          0            0
2                             0           0          0            0
3                             0           0          1            0
4                             0           0          0            0
5                             0           0          0            0
6                             1           0          0            0
  Infrastructure Marketing.and.Promotion Organic Other Processing Production
1              0                       1       0     0          0          0
2              1                       1       1     0          0          0
3              0                       1       1     0          0          0
4              0                       1       0     0          0          0
5              0                       1       0     0          0          0
6              1                       1       0     0          0          0
  Recruitment Season.Extension Training Transportation Value.Added
1           1                1        1              0           1
2           1                1        1              0           1
3           1                0        1              0           1
4           1                0        0              0           0
5           1                0        1              0           0
6           0                0        1              1           0
  Cooperative.Development Diversification Education.Outreach Food.Insecurity
1                       0               1                  0               0
2                       0               1                  0               0
3                       0               1                  0               0
4                       0               0                  0               0
5                       0               0                  0               0
6                       0               0                  0               0
  Food.Hub Resource.Development Strategic.Planning Value.Chain.Coordination
1        0                    0                  0                        0
2        0                    0                  0                        0
3        0                    0                  0                        0
4        0                    0                  0                        0
5        0                    0                  0                        0
6        0                    0                  0                        0
  Not.Specified
1             0
2             0
3             0
4             0
5             0
6             0
                                                                                                         Project.Keywords
1                          Marketing and Promotion, Recruitment, Season Extension, Training, Value Added, Diversification
2 Infrastructure, Marketing and Promotion, Organic, Recruitment, Season Extension, Training, Value Added, Diversification
3          Agritourism, Food Waste, Marketing and Promotion, Organic, Recruitment, Training, Value Added, Diversification
4                                                                                    Marketing and Promotion, Recruitment
5                                                                          Marketing and Promotion, Recruitment, Training
6           Aggregation, Farm to Institution/Wholesale, Infrastructure, Marketing and Promotion, Training, Transportation
  StoryMap.Link Seed.Nof.Success.Highlights
1   No StoryMap                          No
2   No StoryMap                          No
3   No StoryMap                          No
4   No StoryMap                          No
5   No StoryMap                          No
6   No StoryMap                          No</code></pre>
</div>
</div>
<section id="load-city-latlon-dataset" class="level3">
<h3 class="anchored" data-anchor-id="load-city-latlon-dataset">Load city lat/lon dataset</h3>
<p>Loaded directly from <a href="https://github.com/kelvins/US-Cities-Database" title="city lat/lon data dump">GitHub repo</a>.</p>
<p>Going to try to join to cities from LAMP dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">'https://raw.githubusercontent.com/kelvins/US-Cities-Database/main/csv/us_cities.csv'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>city_loc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prep data for merge by renaming some columns, converting city names to all lower case in both data sets to ensure clean join. Note: there are some cities in the city_loc dataset that have more than one row, I think because they are bisected by county lines, so I dealt with that short list of issues by grouping them by city and state and selecting the first row in the group.</p>
<p>Also, there are three remaining rows in the LAMP data that don’t have cities listed, so there are no coords for them, but I could track those down and fix them manually.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lamp <span class="ot">&lt;-</span> lamp <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> State,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> City<span class="fl">.2</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="fu">str_squish</span>(<span class="fu">str_trim</span>(<span class="fu">tolower</span>(city)))) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'HI'</span>, <span class="st">'AK'</span>, <span class="st">'PR'</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>city_loc <span class="ot">&lt;-</span> city_loc <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(ID, COUNTY)) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> CITY,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> STATE_CODE</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">city =</span> <span class="fu">str_squish</span>(<span class="fu">str_trim</span>(<span class="fu">tolower</span>(city)))) <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">%&gt;%</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co"># check how many cities in LAMP data are in city_loc data</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(<span class="fu">unique</span>(lamp<span class="sc">$</span>city)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 960</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(<span class="fu">unique</span>(lamp<span class="sc">$</span>city) <span class="sc">%in%</span> city_loc<span class="sc">$</span>city))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 960</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do the join</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>lamp <span class="ot">&lt;-</span> <span class="fu">merge</span>(lamp, city_loc, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'city'</span>, <span class="st">'state'</span>), <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to sf object</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>lamp_sf <span class="ot">&lt;-</span> lamp <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(LATITUDE, LONGITUDE) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">st_crs</span>(comm_stocks_geo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-lamp-grant-points-to-the-map" class="level3">
<h3 class="anchored" data-anchor-id="add-lamp-grant-points-to-the-map">Add LAMP grant points to the map</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comm_stocks_geo) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> food_secure)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> lamp_sf,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'purple'</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">'purple'</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span><span class="st">"Food Security"</span>, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"BrBG"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="dv">1</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">"cm"</span>),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>,<span class="st">"cm"</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="capstone_report_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>